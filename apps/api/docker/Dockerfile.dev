FROM node:14.16-alpine

WORKDIR /usr/src

RUN apk add -U jq findutils curl && npm install -g pnpm@6.16.1

COPY package.json pnpm-lock.yaml pnpm-workspace.yaml ./
COPY apps/api/package.json apps/api/package.json

RUN pnpm config set store-dir .pnpm-store
RUN pnpm install --frozen-lockfile --ignore-scripts

CMD ["sh", "-c", "pnpm run -C apps/api dev"] 
